#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Run lint-staged for JS/CSS files
npx lint-staged

# Run PHP_CodeSniffer on staged PHP files
STAGED_PHP_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep ".php\{0,1\}$")

if [ "$STAGED_PHP_FILES" != "" ]; then
  echo "Running PHPCS on staged PHP files..."
  ./vendor/bin/phpcs $STAGED_PHP_FILES

  if [ $? != 0 ]; then
    echo "PHPCS found issues. Please fix them before committing."
    echo "You can run 'composer phpcbf' to automatically fix some issues."
    exit 1
  fi
fi

echo "Pre-commit checks passed!"
