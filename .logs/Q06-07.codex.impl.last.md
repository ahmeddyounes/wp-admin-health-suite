**Status:** DONE

**Summary of changes**
- Harden nonce verification to accept `X-WP-Nonce` header or `_wpnonce` param fallback (`includes/REST/RestController.php#L297`).
- Redact/sanitize query analysis output (SQL literals + caller paths) unless debug mode + `WPHA_DEBUG` is enabled (`includes/REST/Performance/QueryAnalysisController.php#L97`).
- Standardize REST date outputs to RFC3339 and sanitize activity fields (`includes/REST/DashboardController.php#L325`).
- Sanitize media attachment REST fields (URLs, title, filename, date) and exclusions metadata (`includes/REST/Media/MediaHelper.php#L104`, `includes/REST/Media/MediaCleanupController.php#L402`, `includes/REST/MediaController.php#L989`).
- Sanitize revision-post rows returned via REST (`includes/REST/DatabaseController.php#L303`, `includes/REST/Database/TableAnalysisController.php#L210`).
- Tighten request arg sanitization/validation for boolean + enums (`includes/REST/Database/CleanupController.php#L172`, `includes/REST/Performance/HeartbeatController.php#L62`, `includes/REST/Performance/AutoloadController.php#L73`).
- Fix `/database/optimization/tables` to handle the current optimizer return shape (`includes/REST/Database/OptimizationController.php#L142`).

**How to verify**
- `npm run lint`
- `npm test`

**Risks / follow-ups**
- Query analysis now redacts SQL by default; to see raw SQL, enable the pluginâ€™s debug mode and set `WPHA_DEBUG` to true (still trimmed to a max length).
- REST route duplication remains for media endpoints (both `MediaController` and the newer `Media/*` controllers register overlapping routes); consider de-duplicating to avoid ambiguous handler selection.