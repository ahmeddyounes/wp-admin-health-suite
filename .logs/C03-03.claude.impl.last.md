---

## Status: DONE

## Summary of Changes

### 1. Created `includes/Application/Media/RunScan.php`
Full application service implementation with:
- **Constructor injection** of 8 dependencies (SettingsInterface, ScannerInterface, DuplicateDetectorInterface, LargeFilesInterface, AltTextCheckerInterface, ReferenceFinderInterface, ExclusionsInterface, optional ActivityLoggerInterface)
- **VALID_TYPES constant**: `full`, `duplicates`, `large_files`, `alt_text`, `unused`, `summary`
- **VALID_DUPLICATE_METHODS constant**: `hash`, `filename`, `both`
- **Core methods**: `execute()`, `execute_by_type()`, `get_summary()`, `get_exclusions_info()`
- **Type-specific scans**: `scan_duplicates()`, `scan_large_files()`, `scan_alt_text()`, `scan_unused()`, `scan_full()`
- **Safe mode support** with `preview_only` indicator in results
- **Exclusions filtering** applied to all scan results
- **Activity logging** with null-safety
- **Performance tracking** with `scan_time_ms`

### 2. Updated `includes/REST/Media/MediaScanController.php`
- Changed constructor to accept `RunScan` instead of `ScannerInterface`
- Added new REST endpoints:
  - `GET /wpha/v1/media/scan/summary`
  - `POST /wpha/v1/media/scan/duplicates`
  - `POST /wpha/v1/media/scan/large-files`
  - `POST /wpha/v1/media/scan/alt-text`
  - `POST /wpha/v1/media/scan/unused`
  - `GET /wpha/v1/media/scan/exclusions`
- Updated `trigger_scan()` to use `execute()` method
- Added `sanitize_options()` method for input validation

### 3. Updated `includes/Providers/RESTServiceProvider.php`
- Added `RunScan::class` and `ActivityLoggerInterface` imports
- Added `RunScan::class` and alias to `$provides` array
- Registered `RunScan` binding with all dependencies
- Updated `MediaScanController` binding to inject `RunScan`

## How to Verify

```bash
npm run lint   # 161 warnings, 0 errors
npm test       # All 417 tests pass
```

## Risks / Follow-ups

1. **New endpoints need integration tests**: The new type-specific endpoints (`/duplicates`, `/large-files`, `/alt-text`, `/unused`, `/exclusions`) don't have dedicated integration tests yet
2. **Activity logging dependency**: ActivityLoggerInterface is optional - if the service isn't registered, logging silently fails (by design)
3. **Background processing**: Async scan scheduling depends on Action Scheduler (`as_enqueue_async_action`) - needs testing with Action Scheduler active
