---

## Summary

**Status: DONE**

### Summary of Changes

Created `tests/unit-standalone/Providers/ProviderContractTest.php` - a comprehensive provider contract test that validates DI container wiring:

1. **Test File Structure:**
   - 22 tests covering all 13 service providers
   - Tests run in standalone mode (no WordPress required)
   - Uses MockConnection and MockCache for dependencies

2. **Tests Included:**
   - `test_all_providers_can_be_instantiated` - Verifies provider instantiation
   - `test_all_providers_can_be_registered` - Verifies registration without exceptions
   - `test_container_boots_all_providers` - Verifies full boot cycle
   - Individual provider tests for bindings (Settings, Core, Database, Media, Performance, Services, Scheduler, AI, REST, Integration, Installer, Multisite, Bootstrap)
   - `test_full_stack_resolves_critical_services` - Comprehensive resolution test
   - `test_deferred_providers_resolve_after_boot` - Tests lazy-loading
   - `test_alias_resolution` - Tests interface-to-alias mapping
   - `test_singleton_services_return_same_instance` - Tests singleton behavior
   - `test_no_circular_dependencies` - Detects dependency loops
   - `test_provider_count` - Ensures no providers are accidentally omitted

3. **Key Implementation Details:**
   - Defines missing constants (`WP_ADMIN_HEALTH_VERSION`, `WP_ADMIN_HEALTH_PLUGIN_DIR`, `WP_ADMIN_HEALTH_PLUGIN_URL`)
   - Sets stored version to match current version to skip upgrade logic
   - Uses `override_with_mocks()` pattern to inject mocks AFTER provider registration but BEFORE boot (since `singleton()` clears existing instances)
   - Skips REST controllers in circular dependency test (they require WordPress `WP_REST_Controller`)

### How to Verify

```bash
# Run just the provider contract tests
./vendor/bin/phpunit --configuration phpunit-standalone.xml tests/unit-standalone/Providers/ProviderContractTest.php

# Run lint check
npm run lint

# Run full test suite
npm test
```

### Risks / Follow-ups

1. **REST Controllers Untested in Standalone Mode**: REST controllers that extend `WP_REST_Controller` cannot be resolved in standalone tests. Full REST API testing requires WordPress integration tests.

2. **Constants Defined at Test Time**: The test defines constants like `WP_ADMIN_HEALTH_VERSION` which may conflict if other tests run after this one. The `if (!defined())` guards mitigate this.

3. **Provider Order Sensitivity**: The test assumes a specific provider registration order. Changes to provider dependencies may require updating `get_provider_classes()`.
