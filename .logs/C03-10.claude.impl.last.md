---

**Status: DONE**

## Summary of changes

Refactored `includes/RestApi.php` from a legacy class with manual `require_once` statements to a thin compatibility wrapper that:

1. **Removed all manual `require_once` statements** - The class no longer loads controller files manually. Instead, it relies on the PSR-4 autoloader to handle class loading.

2. **Added container-based controller resolution** - Controllers are now resolved from the DI container using class-string identifiers, matching the pattern in `RESTServiceProvider`.

3. **Added proper deprecation notices** - Constructor now calls `_doing_it_wrong()` to warn developers if they instantiate this class directly.

4. **Converted deprecated hooks to use `do_action_deprecated()`** - The `wpha_rest_api_init` and `wpha_register_rest_routes` hooks now use WordPress's proper deprecation mechanism instead of `do_action()`.

5. **Used modern controller classes** - The controller list now references the modular controllers (e.g., `CleanupController`, `OptimizationController`, `MediaScanController`) rather than the deleted monolithic controllers (`DatabaseController`, `MediaController`, `PerformanceController`).

## How to verify

```bash
# Run lint (should show only warnings, no errors)
npm run lint

# Run tests (all 417 tests should pass)
npm test

# PHP syntax check
php -l includes/RestApi.php
```

## Risks / follow-ups

1. **Low risk**: If any third-party code directly instantiates `new RestApi($version)`, it will now see a `_doing_it_wrong` notice. This is intentional and the class still works as a thin wrapper.

2. **Follow-up consideration**: In a future release, this class could be removed entirely since `RESTServiceProvider` handles all route registration. The deprecation notices will help identify any remaining usage before removal.
