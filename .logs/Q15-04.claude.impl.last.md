---

## Status: DONE

## Summary of Changes

Created a comprehensive review document for the test factories at `docs/test-factory-review.md` that covers:

**1. PostFactory Analysis**
- `create_with_revisions()` - Properly manages revision filter, generates traceable revision content
- `create_trashed()` - Simple, effective implementation
- `create_many_posts()` - Generates unique titles, returns array of IDs

**2. AttachmentFactory Analysis**
- `create_image()` - Creates proper metadata structure, unique filenames per ID
- `create_with_alt_text()` - Uses correct WordPress meta key
- `create_orphaned()` - Explicitly sets `post_parent` to 0
- `create_many_for_post()` - Associates attachments with parent
- `create_large_file()` - Simulates filesize without creating actual large files

**3. CommentFactory Analysis**
- `create_spam()`/`create_trashed()` - Use correct WordPress status values
- `create_many_for_post()` - Generates unique content
- `create_with_author()` - Supports user association
- `create_thread()` - Creates realistic threaded structure, returns structured data

**Key Findings:**
- All factories properly extend WordPress's WP_UnitTest_Factory_For_* classes
- Methods create properly structured WordPress data
- Return values are consistent (IDs or structured arrays)
- Documentation is complete with PHPDoc comments
- Factories follow WordPress testing best practices

## How to Verify

```bash
# Run lint (should show only pre-existing warnings, no errors)
npm run lint

# Run tests (all 417 tests should pass)
npm test

# View the review document
cat docs/test-factory-review.md
```

## Risks / Follow-ups

1. **Factory Registration**: The custom factories are defined but may need explicit instantiation to use their custom methods via `$this->factory()->post->create_with_revisions()`. Current tests mostly use TestCase helper methods or direct factory calls.

2. **Underutilization**: The factories have useful methods that aren't fully leveraged by current tests. Future tests could benefit from using methods like `create_with_revisions()`, `create_thread()`, and `create_orphaned()`.

3. **No Physical Files**: AttachmentFactory doesn't create actual files - tests that need real files must create them explicitly (this is by design for efficiency).
