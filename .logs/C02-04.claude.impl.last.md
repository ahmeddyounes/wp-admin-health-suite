---

**Status: DONE**

## Summary of Changes

### New Files Created
1. **`includes/Contracts/IntegrationFactoryInterface.php`** - New interface defining the contract for creating integration instances via the container. Methods: `create()`, `can_create()`, `get_available_ids()`.

2. **`includes/Integrations/IntegrationFactory.php`** - Implementation that resolves integrations from the container using a service map. Includes `register()` method to map integration IDs to container service identifiers.

### Modified Files
3. **`includes/Integrations/IntegrationManager.php`**:
   - Added constructor accepting optional `IntegrationFactoryInterface`
   - Added `$factory` property
   - Refactored `discover()` to use new `discover_builtin_integrations()` method
   - Added `create_integration()` method that tries factory first, then falls back to direct instantiation
   - Added `set_factory()` and `get_factory()` methods for lazy injection
   - Fixed ACF class reference from `Acf` to `ACF` (case-sensitivity fix)

4. **`includes/Providers/IntegrationServiceProvider.php`**:
   - Registers each built-in integration (WooCommerce, Elementor, ACF, Multilingual) in the container with proper `ConnectionInterface` and `CacheInterface` dependencies
   - Registers the `IntegrationFactory` as a singleton with built-in integrations pre-registered
   - Creates `IntegrationManager` with factory injection
   - Added new hook `wpha_configure_integration_factory` for third-party factory registration

5. **`docs/developers/hooks.md`**:
   - Added new "Integration Hooks" section documenting:
     - `wpha_register_integrations`
     - `wpha_configure_integration_factory`
     - `wpha_before_integration_discovery`
     - `wpha_integrations_loaded`
     - `wpha_integration_initialized`
     - `wpha_integration_deactivated`

## How to Verify

1. **Lint**: `npm run lint` - Passes (warnings only, no errors)
2. **Tests**: `npm test` - All 417 tests pass

## Risks / Follow-ups

1. **Backward Compatibility**: The factory is optional - if not provided, IntegrationManager falls back to direct instantiation, preserving backward compatibility.

2. **Third-Party Integration Registration**: Two methods are now available:
   - Use `wpha_register_integrations` hook with `$manager->register($integration)` (existing approach)
   - Use `wpha_configure_integration_factory` hook with `$factory->register($id, $class)` for container-based resolution (new approach)

3. **PHP Unit Tests**: No PHP unit tests were run (only JS tests). Consider adding PHP unit tests for `IntegrationFactory` and the updated `IntegrationManager`.
